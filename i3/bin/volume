#!/bin/bash

channel=$(pactl list short sinks | grep 'RUNNING' | sed -e 's,^\([0-9][0-9]*\)[^0-9].*,\1,')

print_volume() {
    if [[ "$(pactl list sinks | grep 'Mute: ' | sed 's/\tMute: //g')" == 'yes' ]]
    then
        echo "MUTE"
    else
        echo "$(pactl list sinks | grep "Sink #$channel" -A9 | grep '^[[:space:]]Volume:' | head -n 1 | tail -n 1 | sed -e 's,.* \([0-9][0-9]*\)%.*,\1,')%"
    fi
}

inc() {
    pactl set-sink-volume $channel +5%
}

dec() {
    pactl set-sink-volume $channel -5%
}

mute() {
    pactl set-sink-mute $channel toggle
}

if [ ! -z "$BLOCK_BUTTON" ]; then
    case $BLOCK_BUTTON in
        1) pavucontrol ;;
        4) inc ;;
        5) dec ;;
        2) mute ;;
    esac
fi

if [ ! -z "$1" ]; then
    case $1 in
        up) inc ;;
        down) dec ;;
        mute) mute ;;
    esac
fi

print_volume